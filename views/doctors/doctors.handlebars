

<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="/">{{localize 'breadcrumbs.home'}}</a></li>
        <li class="breadcrumb-item active" aria-current="page">{{PAGE_TITLE}}</li>
    </ol>
</nav>

<div class="row">

    <div class="col-xl-4 push-xl-8 col-lg-12 push-lg-0">

        <nav class="sticky-top">
            <div id="map" style="height:400px">
            </div><!--/.map-->
            <script>
                var locations = {{{jsonify hospitals}}};
                var avgCoordinates = {{{jsonify avgCoordinates}}}
                var doctors = {{{jsonify doctors}}}
                function initLocationsMap() {
                    var center = avgCoordinates || {lat: 39.529, lng: -101.369};
                    
                    if (locations.length === 1) {
                        center.lat = doctors[0].coordinations[0].lat;
                        center.lng = doctors[0].coordinations[0].lon;
                    }
                    var map = new google.maps.Map(
                        document.getElementById('map'),
                        {center: center, zoom: 3}
                    );

                    
                    var infowindow = new google.maps.InfoWindow({
                        content: ''
                    });

                    for (var i = 0, length = locations.length; i < length; i++) {
                        var hospital = locations[i];
                        var doctor = doctors[i];
                        var marker = new google.maps.Marker({
                            position: {lat: doctor.coordinations[0].lat, lng: doctor.coordinations[0].lon}, 
                            title: hospital.name,
                            map: map,
                        });

                        google.maps.event.addListener(marker, 'click', (function(marker, content, infowindow){ 
                            return function() {
                                infowindow.setContent(content);
                                infowindow.open(map, marker);
                            };
                        })(marker, getInfoWindowContent(doctor), infowindow));  
                    }
                }

                function getInfoWindowContent(doctor) {
                    return '<div class="info-window">' + 
                    '<h5>' + (doctor.name || '') + '</h5>' +
                    '<i>' + (doctor.hospital.location.address || '') + '</i><br/><br/>' +
                    '<a href="/doctors/' + doctor.id.toString() + '">View Doctor</a>' 
                    '</div>';
                }
            </script>
        </nav>

        <script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA839hvZlHkWX80W6YRTuv3C7HToNVZhwc&callback=initLocationsMap">
        </script>

    </div>
    <!--/.col-->

    <div class="col-xl-8 pull-xl-4 col-lg-12 pull-lg-0">
    {{!-- <div class="col-xl-12 col-lg-12"> --}}
        <ul class="items-list doctors-items">

            {{#each doctors as |doctor|}}
            <li>
                <div class="row">
                    <div class="col-xl-3 col-md-3 col-sm-4">
                        <a class="avatar" href="/doctor"><div class="crop"><img src="img/_demo/doctor1.jpg" alt="A doctor's photo" onerror="this.onerror=null;this.src='/img/logo_stub.svg';this.style.width='100px';" /></div></a>
                        {{!-- <div class="text-success" data-toggle="tooltip" data-placement="top" title="Participant in the program of insurance points"><i class="fas fa-heartbeat"></i> Insurance</div> --}}
                    </div>
                    <!--/.col-->
                    <div class="col-xl-6 col-md-5 col-sm-8">
                        <h3><a href="/doctors/{{doctor.id}}">{{doctor.name}}</a> <small>M.D</small></h3>
                        <div><a href="/doctors">{{doctor.specialization}}</a></div>
                        <h4><a href="/clinics/{{doctor.hispital.id}}">{{doctor.hospital.name}}</a></h4>
                        <p><a class="map-toggle" data-name="{{doctor.hospital.name}}" href="/doctors">{{doctor.hospital.location.address}}</a></p>
                        <div>{{{localize "doctor.workExperience" years="9+"}}}</div>
                        <div>{{{localize "doctor.bonus" amount="100"}}}</div>
                    </div>
                    <div class="col-xl-3 col-md-4 col-sm-12">
                        <div class="wave text-center">
                            <h4>{{localize 'ratings.rating'}} <strong class="text-success">{{doctor.rate}}</strong></h4>
                            <p>{{localize 'ratings.basedOn'}} <strong><a class="" href="/doctors/{{doctor.id}}#opinions">{{doctor.ratings.length}} {{localize 'ratings.opinions'}}</a></strong></p>
                            <a class="btn btn-primary btn-lg justify book-button" href="/booking/?doctorId={{doctor.id}}">{{localize 'doctor.bookToVisit'}}</a>
                        </div>
                        <!--/.wave-->
                    </div>
                    <!--/.col-->
                </div>
                <!--/.row-->
            </li>
            {{/each}}
        </ul>

        <div class="row pagination-line">
            <div class="col">
                <nav aria-label="...">
                    {{> pager pagerInfo }}
                </nav>
            </div>
        </div>

    </div>
    <!--/.col-->

</div>
<!--/.row-->